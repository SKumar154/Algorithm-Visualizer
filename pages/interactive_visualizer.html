<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Visualizer - Algorithm Visualizer</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Falgorithm1524back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.6"></script>
</head>
<body class="bg-background text-text-primary">
    <!-- Navigation Header -->
    <nav class="bg-white shadow-md border-b border-border sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="homepage.html" class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                            </svg>
                        </div>
                        <span class="text-xl font-bold text-primary">Algorithm Visualizer</span>
                    </a>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="homepage.html" class="text-text-secondary hover:text-primary transition-colors">Home</a>
                    <a href="algorithm_explorer.html" class="text-text-secondary hover:text-primary transition-colors">Explore</a>
                    <a href="interactive_visualizer.html" class="text-primary font-medium border-b-2 border-primary pb-1">Visualizer</a>
                    <a href="learning_pathways.html" class="text-text-secondary hover:text-primary transition-colors">Resources</a>
                    <a href="code_laboratory.html" class="text-text-secondary hover:text-primary transition-colors">Code Lab</a>
                    <a href="community_hub.html" class="text-text-secondary hover:text-primary transition-colors">Community</a>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button class="text-text-secondary hover:text-primary">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Visualizer Interface -->
    <div class="min-h-screen bg-surface">
        <!-- Top Toolbar -->
        <div class="bg-white border-b border-border px-4 py-3">
            <div class="max-w-7xl mx-auto flex items-center justify-between">
                <!-- Algorithm Selection -->
                <div class="flex items-center space-x-4">
                    <!-- Searchable Combobox -->
                    <div class="combobox" id="algorithmCombobox">
                        <svg class="combobox-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z"/>
                        </svg>
                        <input id="algorithmSearch" type="text" class="combobox-input" placeholder="Search algorithms..." autocomplete="off" />
                        <div id="algorithmList" class="combobox-list hidden"></div>
                    </div>
                </div>

                <!-- Control Buttons -->
                <div class="flex items-center space-x-3">
                    <button class="px-4 py-2 bg-accent text-white rounded-lg text-sm font-medium hover:bg-accent-600 transition-colors" id="playBtn">
                        <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                        Play
                    </button>
                    <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-300 transition-colors" id="pauseBtn">
                        <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                        </svg>
                        Pause
                    </button>
                    <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-300 transition-colors" id="stepBtn">
                        <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                        </svg>
                        Step
                    </button>
                    <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-300 transition-colors" id="resetBtn">
                        <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
                        </svg>
                        Reset
                    </button>

                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="max-w-7xl mx-auto p-4">
            <div class="grid lg:grid-cols-12 gap-6">
                <!-- Left Panel - Step-by-Step Explanation -->
                <div class="lg:col-span-6">
                    <div class="card h-full">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-primary">Step-by-Step Explanation</h3>
                            <!-- <div class="w-3 h-3 bg-accent rounded-full animate-pulse"></div> -->
                        </div>
                        <div class="rounded-lg p-1 overflow-y-auto max-h-96">
                            <div class="space-y-4 viz-steps" id="stepsContainer">
                                <div class="step-item"><div class="step-number bg-primary text-white rounded-full">1</div><div class="step-content"><div class="step-title">Initialize QuickSort</div><div class="step-desc">Starting QuickSort with the entire array. We'll select the last element (11) as our pivot and partition the array around it.</div></div></div>
                                <div class="step-item"><div class="step-number bg-primary text-white rounded-full">2</div><div class="step-content"><div class="step-title">Visualize QuickSort</div><div class="step-desc">Observe bars as elements compare and swap around the pivot. Smaller move left, larger move right.</div></div></div>
                                <div class="step-item"><div class="step-number bg-primary text-white rounded-full">3</div><div class="step-content"><div class="step-title">Choose Pivot Element</div><div class="step-desc">Rightmost element is chosen as pivot for this demo.</div></div></div>
                                <div class="step-item"><div class="step-number bg-primary text-white rounded-full">4</div><div class="step-content"><div class="step-title">Partition Array</div><div class="step-desc">Compare each element with pivot. Elements smaller go left of pivot index.</div></div></div>
                                <div class="step-item"><div class="step-number bg-primary text-white rounded-full">5</div><div class="step-content"><div class="step-title">Swap Elements</div><div class="step-desc">Swap when a smaller element is found to place it before pivot region.</div></div></div>
                                <div class="step-item"><div class="step-number bg-primary text-white rounded-full">6</div><div class="step-content"><div class="step-title">Place Pivot in Position</div><div class="step-desc">Put pivot into its correct sorted position.</div></div></div>
                                <div class="step-item"><div class="step-number bg-primary text-white rounded-full">7</div><div class="step-content"><div class="step-title">Recursive Sort</div><div class="step-desc">Recursively apply QuickSort to left and right subarrays until fully sorted.</div></div></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Panel - Visualization Canvas -->
                <div class="lg:col-span-6">
                    <div class="card">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-primary" id="algorithmTitle">QuickSort Visualization</h3>
                            <div class="flex items-center space-x-2 text-sm text-text-secondary">
                                <span>Array Size: 20</span>
                                <span>•</span>
                                <span>Step: 0/45</span>
                            </div>
                        </div>

                        <!-- Visualization Canvas -->
                        <div class="bg-gray-50 rounded-lg p-6 mb-4" style="min-height: 300px;">
                            <div class="flex items-end justify-center space-x-1 h-64" id="visualizationCanvas">
                                <!-- Sorting Bars -->
                                <div class="w-6 bg-primary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 60%" data-value="12">12</div>
                                <div class="w-6 bg-secondary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 85%" data-value="17">17</div>
                                <div class="w-6 bg-primary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 40%" data-value="8">8</div>
                                <div class="w-6 bg-accent-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 95%" data-value="19">19</div>
                                <div class="w-6 bg-primary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 70%" data-value="14">14</div>
                                <div class="w-6 bg-secondary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 30%" data-value="6">6</div>
                                <div class="w-6 bg-primary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 80%" data-value="16">16</div>
                                <div class="w-6 bg-accent-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 50%" data-value="10">10</div>
                                <div class="w-6 bg-primary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 75%" data-value="15">15</div>
                                <div class="w-6 bg-secondary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 35%" data-value="7">7</div>
                                <div class="w-6 bg-primary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 90%" data-value="18">18</div>
                                <div class="w-6 bg-accent-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 45%" data-value="9">9</div>
                                <div class="w-6 bg-primary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 65%" data-value="13">13</div>
                                <div class="w-6 bg-secondary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 25%" data-value="5">5</div>
                                <div class="w-6 bg-primary-400 rounded-t transition-all duration-800 flex items-end justify-center text-xs text-white font-medium pb-1" style="height: 55%" data-value="11">11</div>
                            </div>
                        </div>

                        <!-- Progress Bar -->
                        <div class="mb-4">
                            <div class="flex justify-between text-sm text-text-secondary mb-2">
                                <span>Progress</span>
                                <span>0% Complete</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3 cursor-pointer" id="progressBar">
                                <div class="bg-accent h-3 rounded-full transition-all duration-300" style="width: 0%" id="progressFill"></div>
                            </div>
                        </div>

                        <!-- Color Legend -->
                        <div class="flex flex-wrap items-center justify-center gap-4 text-sm">
                            <div class="flex items-center space-x-2">
                                <div class="w-4 h-4 bg-primary-400 rounded"></div>
                                <span>Unsorted</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-4 h-4 bg-accent-400 rounded"></div>
                                <span>Pivot</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-4 h-4 bg-secondary-400 rounded"></div>
                                <span>Comparing</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-4 h-4 bg-accent rounded"></div>
                                <span>Sorted</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- (Top row ends here) -->
            </div>

            <!-- Bottom Panel - Complexity & Code -->
            <div class="grid lg:grid-cols-12 gap-6 mt-6">
                <!-- Complexity Analysis (1/3) -->
                <div class="lg:col-span-6 card h-full">
                    <h3 class="text-lg font-semibold text-primary mb-4">Complexity Analysis</h3>
                    <div class="space-y-4">
                        <div class="info-box info-box-blue">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-primary">Time Complexity</span>
                                
                            </div>
                            <div class="grid grid-cols-3 gap-3 text-sm">
                                <div class="text-center"><div class="text-primary font-medium">Best</div><div class="text-text-secondary" id="timeBest">O(n log n)</div></div>
                                <div class="text-center"><div class="text-primary font-medium">Average</div><div class="text-text-secondary" id="timeAvg">O(n log n)</div></div>
                                <div class="text-center"><div class="text-primary font-medium">Worst</div><div class="text-text-secondary" id="timeWorst">O(n²)</div></div>
                            </div>
                        </div>

                        <div class="info-box info-box-blue">
                            <div class="flex items-center justify-between mb-8">
                                <span class="text-sm font-medium text-primary">Space Complexity</span>
                                <span class="text-sm text-primary font-medium text-center w-24" id="spaceSummary">O(log n)</span>
              
                            </div>
                            <div class="text-xs text-text-secondary" id="spaceNote">Due to recursive call stack</div>
                        </div>

                        <div class="info-box info-box-blue">
                            <div class="text-sm font-medium text-text-primary mb-2">Operations</div>
                            <div class="grid grid-cols-3 gap-3 text-sm">
                                <div class="text-center"><div class="text-text-secondary">Comparisons</div><div class="text-primary font-medium" id="comparisonsCount">0</div></div>
                                <div class="text-center"><div class="text-text-secondary">Swaps</div><div class="text-primary font-medium" id="swapsCount">0</div></div>
                                <div class="text-center"><div class="text-text-secondary">Steps</div><div class="text-primary font-medium" id="stepsCount">0 / 45</div></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Code of the Algorithm (2/3) -->
                <div class="lg:col-span-6 card h-full">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-primary">Code of the Algorithm</h3>
                        <select class="form-input w-24 text-sm" id="languageSelect">
                            <option value="python">Python</option>
                            <option value="java">Java</option>
                            <option value="cpp">C++</option>
                        </select>
                    </div>
                    <div class="bg-gray-900 rounded-lg p-4 font-mono text-sm overflow-y-auto max-h-96">
                        <div class="text-gray-300" id="codeContainer">
                            <div class="text-blue-400">def</div> <div class="text-yellow-300 inline">quicksort</div><div class="text-gray-300 inline">(arr, low, high):</div>
                            <div class="ml-4 text-purple-400">if</div> <div class="text-gray-300 inline">low < high:</div>
                            <div class="ml-8 text-gray-300">pi = partition(arr, low, high)</div>
                            <div class="ml-8 text-gray-300">quicksort(arr, low, pi - 1)</div>
                            <div class="ml-8 text-gray-300">quicksort(arr, pi + 1, high)</div>
                            <br />
                            <div class="text-blue-400">def</div> <div class="text-yellow-300 inline">partition</div><div class="text-gray-300 inline">(arr, low, high):</div>
                            <div class="ml-4 text-gray-300">pivot = arr[high]</div>
                            <div class="ml-4 text-gray-300">i = low - 1</div>
                            <br />
                            <div class="ml-4 text-purple-400">for</div> <div class="text-gray-300 inline">j in range(low, high):</div>
                            <div class="ml-8 text-purple-400">if</div> <div class="text-gray-300 inline">arr[j] <= pivot:</div>
                            <div class="ml-12 text-gray-300">i += 1</div>
                            <div class="ml-12 text-gray-300">arr[i], arr[j] = arr[j], arr[i]</div>
                            <br />
                            <div class="ml-4 text-gray-300">arr[i + 1], arr[high] = arr[high], arr[i + 1]</div>
                            <div class="ml-4 text-purple-400">return</div> <div class="text-gray-300 inline">i + 1</div>
                        </div>
                    </div>
                    
                    <!-- Copy Code Button -->
                    <button class="w-full mt-3 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-300 transition-colors">
                        <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                        </svg>
                        Copy Code
                    </button>
                </div>
            </div>

            <!-- Custom Dataset panel removed per design -->
        </div>
    </div>

    <!-- Mobile touch controls removed per design -->

    <!-- Footer removed for this page per design -->

    <script>
        // Basic interactivity for demonstration
        document.addEventListener('DOMContentLoaded', function() {
            const playBtn = document.getElementById('playBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            const stepBtn = document.getElementById('stepBtn');
            const resetBtn = document.getElementById('resetBtn');
            const progressFill = document.getElementById('progressFill');
            const operationsCount = document.getElementById('operationsCount');
            const comparisonsCount = document.getElementById('comparisonsCount');
            const swapsCount = document.getElementById('swapsCount');
            const stepsContainer = document.getElementById('stepsContainer');
            const stepsCount = document.getElementById('stepsCount');
            const algorithmTitle = document.getElementById('algorithmTitle');

            // Searchable combobox refs
            const combo = document.getElementById('algorithmCombobox');
            const comboInput = document.getElementById('algorithmSearch');
            const comboList = document.getElementById('algorithmList');

            let currentStep = 0;
            let totalSteps = 45;
            let operations = 0;
            let comparisons = 0;
            let swaps = 0;
            let intervalRef = null;

            const algorithms = [
                'QuickSort', 'MergeSort', 'BubbleSort', 'Insertion Sort', 'Selection Sort',
                "Dijkstra's Algorithm", 'Breadth-First Search', 'Depth-First Search'
            ];

            const algorithmData = {
                'QuickSort': {
                    time: { best: 'O(n log n)', avg: 'O(n log n)', worst: 'O(n²)' },
                    space: { summary: 'O(log n)', note: 'Due to recursive call stack' },
                    code: {
                        python: `def quicksort(arr, low, high):\n    if low < high:\n        pi = partition(arr, low, high)\n        quicksort(arr, low, pi - 1)\n        quicksort(arr, pi + 1, high)\n\ndef partition(arr, low, high):\n    pivot = arr[high]\n    i = low - 1\n    for j in range(low, high):\n        if arr[j] <= pivot:\n            i += 1\n            arr[i], arr[j] = arr[j], arr[i]\n    arr[i+1], arr[high] = arr[high], arr[i+1]\n    return i + 1`
                    }
                },
                'MergeSort': {
                    time: { best: 'O(n log n)', avg: 'O(n log n)', worst: 'O(n log n)' },
                    space: { summary: 'O(n)', note: 'Auxiliary arrays for merging' },
                    code: { python: `def merge_sort(a):\n    if len(a) <= 1: return a\n    mid = len(a)//2\n    left = merge_sort(a[:mid])\n    right = merge_sort(a[mid:])\n    return merge(left, right)` }
                },
                'BubbleSort': {
                    time: { best: 'O(n)', avg: 'O(n²)', worst: 'O(n²)' },
                    space: { summary: 'O(1)', note: 'In-place' },
                    code: { python: `def bubble(a):\n    n=len(a)\n    for i in range(n):\n        for j in range(0, n-i-1):\n            if a[j] > a[j+1]:\n                a[j], a[j+1] = a[j+1], a[j]` }
                },
                "Dijkstra's Algorithm": {
                    time: { best: 'O((V+E) log V)', avg: 'O((V+E) log V)', worst: 'O((V+E) log V)' },
                    space: { summary: 'O(V+E)', note: 'Graph and priority queue' },
                    code: { python: `import heapq\n\ndef dijkstra(g, s):\n    dist = {v: float('inf') for v in g}\n    dist[s] = 0\n    pq = [(0, s)]\n    while pq:\n        d,u = heapq.heappop(pq)\n        if d!=dist[u]: continue\n        for v,w in g[u]:\n            nd = d + w\n            if nd < dist[v]:\n                dist[v] = nd\n                heapq.heappush(pq,(nd,v))\n    return dist` }
                },
                'Breadth-First Search': {
                    time: { best: 'O(V+E)', avg: 'O(V+E)', worst: 'O(V+E)' },
                    space: { summary: 'O(V)', note: 'Queue of nodes' },
                    code: { python: `from collections import deque\n\ndef bfs(g, s):\n    q=deque([s]); seen={s}\n    order=[]\n    while q:\n        u=q.popleft(); order.append(u)\n        for v in g[u]:\n            if v not in seen:\n                seen.add(v); q.append(v)\n    return order` }
                },
                'Depth-First Search': {
                    time: { best: 'O(V+E)', avg: 'O(V+E)', worst: 'O(V+E)' },
                    space: { summary: 'O(V)', note: 'Call stack' },
                    code: { python: `def dfs(g, s, seen=None, order=None):\n    if seen is None: seen=set(); order=[]\n    seen.add(s); order.append(s)\n    for v in g[s]:\n        if v not in seen: dfs(g, v, seen, order)\n    return order` }
                }
            };

            function renderCode(algName) {
                const lang = document.getElementById('languageSelect').value || 'python';
                const code = (algorithmData[algName] && algorithmData[algName].code[lang]) || '';
                const container = document.getElementById('codeContainer');
                if (!code) return;
                container.innerHTML = `<pre class="text-gray-300 whitespace-pre-wrap">${code.replace(/&/g,'&amp;').replace(/</g,'&lt;')}</pre>`;
            }

            function renderComplexity(algName) {
                const data = algorithmData[algName];
                if (!data) return;
                document.getElementById('timeBest').textContent = data.time.best;
                document.getElementById('timeAvg').textContent = data.time.avg;
                document.getElementById('timeWorst').textContent = data.time.worst;
                document.getElementById('timeSummary').textContent = `${data.time.avg} avg`;
                document.getElementById('spaceSummary').textContent = data.space.summary;
                document.getElementById('spaceNote').textContent = data.space.note;
            }

            function loadAlgorithm(algName) {
                algorithmTitle.textContent = `${algName} Visualization`;
                renderCode(algName);
                renderComplexity(algName);
            }

            function openList() { comboList.classList.remove('hidden'); }
            function closeList() { comboList.classList.add('hidden'); }
            function filterList(value) {
                const v = value.toLowerCase();
                const items = algorithms.filter(a => a.toLowerCase().includes(v));
                comboList.innerHTML = items.map(a => `<div class=\"combobox-item\" data-value=\"${a}\">${a}</div>`).join('');
            }

            if (comboInput) {
                comboInput.addEventListener('input', (e) => { filterList(e.target.value); openList(); });
                comboInput.addEventListener('focus', () => { filterList(comboInput.value); openList(); });
            }
            document.addEventListener('click', (e) => { if (!combo || !combo.contains(e.target)) { closeList(); } });
            comboList.addEventListener('click', (e) => {
                const item = e.target.closest('.combobox-item');
                if (!item) return;
                const val = item.getAttribute('data-value');
                comboInput.value = val;
                closeList();
                loadAlgorithm(val);
            });
            comboInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    const val = comboInput.value.trim();
                    if (algorithms.includes(val)) { loadAlgorithm(val); closeList(); }
                }
            });

            playBtn.addEventListener('click', function() {
                if (intervalRef) return;
                const delay = 1000; // default speed (speed control removed)
                intervalRef = setInterval(tick, delay);
            });

            stepBtn.addEventListener('click', function() {
                if (currentStep < totalSteps) {
                    tick();
                }
            });

            resetBtn.addEventListener('click', function() {
                currentStep = 0;
                operations = 0;
                comparisons = 0;
                swaps = 0;
                clearInterval(intervalRef);
                intervalRef = null;
                updateProgress();
                updateStepsVisualization();
            });

            pauseBtn.addEventListener('click', function() {
                clearInterval(intervalRef);
                intervalRef = null;
            });

            function updateProgress() {
                const percentage = (currentStep / totalSteps) * 100;
                progressFill.style.width = percentage + '%';
                operationsCount && (operationsCount.textContent = operations);
                comparisonsCount.textContent = comparisons;
                swapsCount.textContent = swaps;
                stepsCount && (stepsCount.textContent = `${currentStep} / ${totalSteps}`);
            }

            function tick() {
                if (currentStep >= totalSteps) {
                    clearInterval(intervalRef);
                    intervalRef = null;
                    return;
                }
                currentStep++;
                operations++;
                if (Math.random() > 0.5) comparisons++;
                if (Math.random() > 0.7) swaps++;
                updateProgress();
                updateStepsVisualization();
            }

            function updateStepsVisualization() {
                const items = stepsContainer.querySelectorAll('.step-number');
                items.forEach((dot, index) => {
                    dot.classList.remove('opacity-60');
                    if (currentStep === 0) return;
                    const stepThreshold = Math.ceil(((index + 1) / items.length) * totalSteps);
                    if (currentStep < stepThreshold) {
                        dot.classList.add('opacity-60');
                    }
                });
            }

            // Initial
            loadAlgorithm('QuickSort');
        });
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>